<title>文件上传</title>

<link rel="stylesheet" href="/lib/blueimp-file-upload/css/jquery.fileupload.css">
<link rel="stylesheet" href="/vendor/dropify/dist/css/dropify.min.css">

<div class="page page-full animation-fade page-forms">
    <div class="page-header">
        <h1 class="page-title">文件上传</h1>
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a>首页</a>
            </li>
            <li class="breadcrumb-item">
                <a href="javascript:;">表单</a>
            </li>
            <li class="breadcrumb-item active">文件上传</li>
        </ol>
    </div>
    <div class="page-content">

        <div class="panel">
            <div class="panel-heading">
                <h3 class="panel-title">Dropify
                    <small>
                        <a class="example-plugin-link" href="https://jeremyfagis.github.io/dropify/" target="_blank">
                            官网
                        </a>
                    </small>
                </h3>
            </div>
            <div class="panel-body container-fluid">
                <div class="row row-lg">
                    <div class="col-lg-4 col-sm-6">

                        <div class="example-wrap">
                            <h4 class="example-title">默认</h4>
                            <div class="example">
                                <input type="file" class="form-control" id="input-file-now" data-plugin="dropify" data-default-file="">
                            </div>
                        </div>

                    </div>
                    <div class="col-lg-4 col-sm-6">

                        <div class="example-wrap">
                            <h4 class="example-title">设置默认值</h4>
                            <div class="example">
                                <input type="file" class="form-control" id="input-file-now-custom-1" data-plugin="dropify" data-default-file="/static/images/placeholder.png">
                            </div>
                        </div>

                    </div>
                    <div class="clearfix visible-sm-block visible-md-block"></div>
                    <div class="col-lg-4 col-sm-6">

                        <div class="example-wrap">
                            <h4 class="example-title">设置高度</h4>
                            <div class="example">
                                <input type="file" class="form-control" id="input-file-now-custom-2" data-plugin="dropify" data-height="500">
                            </div>
                        </div>

                    </div>
                    <div class="col-lg-4 col-sm-6">

                        <div class="example-wrap">
                            <h4 class="example-title">多个设置项</h4>
                            <div class="example">
                                <input type="file" class="form-control" id="input-file-now-custom-3" data-plugin="dropify" data-height="500" data-default-file="/static/images/placeholder.png">
                            </div>
                        </div>

                    </div>
                    <div class="clearfix visible-sm-block visible-md-block"></div>
                    <div class="col-lg-4 col-sm-6">

                        <div class="example-wrap">
                            <h4 class="example-title">禁用</h4>
                            <div class="example">
                                <input type="file" class="form-control" id="input-file-now-disabled-1" data-plugin="dropify" disabled="disabled">
                            </div>
                        </div>

                    </div>
                    <div class="col-lg-4 col-sm-6">

                        <div class="example-wrap">
                            <h4 class="example-title">默认文件</h4>
                            <div class="example">
                                <input type="file" class="form-control" id="input-file-now-disabled-2" data-plugin="dropify" disabled="disabled" data-default-file="/static/images/placeholder.png">
                            </div>
                        </div>

                    </div>
                    <div class="clearfix visible-sm-block visible-md-block"></div>
                    <div class="col-lg-4 col-sm-6">

                        <div class="example-wrap">
                            <h4 class="example-title">文件大小限制</h4>
                            <div class="example">
                                <input type="file" class="form-control" id="input-file-max-fs" data-plugin="dropify" data-max-file-size="2M">
                            </div>
                        </div>

                    </div>
                    <div class="col-lg-4 col-sm-6">

                        <div class="example-wrap">
                            <h4 class="example-title">禁用移除按钮</h4>
                            <div class="example">
                                <input type="file" class="form-control" id="input-file-disable-remove" data-plugin="dropify" data-disable-remove="true">
                            </div>
                        </div>

                    </div>
                    <div class="clearfix visible-sm-block visible-md-block"></div>
                    <div class="col-lg-4 col-sm-6">

                        <div class="example-wrap">
                            <h4 class="example-title">事件</h4>
                            <div class="example">
                                <input type="file" class="form-control" id="input-file-events" class="dropify-event" data-default-file="/static/images/placeholder.png">
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="example-wrap">
            <h3 class="example-title">jQuery File Upload
                <small>
                    <a class="example-plugin-link" href="https://blueimp.github.io/jQuery-File-Upload/" target="_blank">
                        官网
                    </a>
                </small>
            </h3>
            <form class="upload-form" id="exampleUploadForm" method="POST">
                <input type="file" id="inputUpload" name="files[]" multiple="">
                <div class="uploader-inline">
                    <h4 class="upload-instructions">单击或直接拖动需要上传的文件到此处</h4>
                </div>
                <div class="file-wrap container-fluid">
                    <div class="file-list row"></div>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="/vendor/jquery-ui/jquery-ui.min.js" data-name="jquery-ui"></script>
<script src="/vendor/blueimp-tmpl/js/tmpl.min.js"></script>
<script src="/vendor/blueimp-canvas-to-blob/js/canvas-to-blob.min.js"></script>
<script src="/vendor/blueimp-load-image/js/load-image.all.min.js"></script>
<script src="/vendor/blueimp-file-upload/js/jquery.fileupload.js" data-name="fileupload" data-deps="jquery-ui"></script>
<script src="/vendor/blueimp-file-upload/js/jquery.fileupload-process.js" data-name="fileupload-process" data-deps="fileupload"></script>
<script src="/vendor/blueimp-file-upload/js/jquery.fileupload-image.js" data-deps="fileupload,fileupload-process"></script>
<script src="/vendor/blueimp-file-upload/js/jquery.fileupload-audio.js" data-deps="fileupload"></script>
<script src="/vendor/blueimp-file-upload/js/jquery.fileupload-video.js" data-deps="fileupload"></script>
<script src="/vendor/blueimp-file-upload/js/jquery.fileupload-validate.js" data-deps="fileupload"></script>
<script src="/vendor/blueimp-file-upload/js/jquery.fileupload-ui.js" data-deps="fileupload"></script>
<script src="/vendor/dropify/dist/js/dropify.min.js"></script>

<script>
/**
 * QAdmin v1.2.0 (http://www.qadmin.com/)
 * Copyright 2015-2017 QAdmin Team
 * Licensed under the QAdmin License 1.0 (http://www.qadmin.com/about/#license)
 */
(function (document, window, $) {
    'use strict';

    var $exampleUploadForm = $('#exampleUploadForm');
    // 文件上传
    // -------------------
    $exampleUploadForm.fileupload({
        url: $.ctx + '../../server/fileupload/',
        dropzone: $exampleUploadForm,
        filesContainer: $('.file-list'),
        uploadTemplateId: false,
        downloadTemplateId: false,
        uploadTemplate: tmpl(
            '{% for (var i=0, file; file=o.files[i]; i++) { %}' +
            '<div class="file template-upload fade col-lg-2 col-md-4 col-sm-6 {%=file.type.search("image") !== -1? "image" : "other-file"%}">' +
            '<div class="file-item">' +
            '<div class="preview vertical-align">' +
            '<div class="file-action-wrap">' +
            '<div class="file-action">' +
            '{% if (!i && !o.options.autoUpload) { %}' +
            '<i class="icon wb-upload start" data-toggle="tooltip" data-original-title="Upload file" aria-hidden="true"></i>' +
            '{% } %}' +
            '{% if (!i) { %}' +
            '<i class="icon wb-close cancel" data-toggle="tooltip" data-original-title="Stop upload file" aria-hidden="true"></i>' +
            '{% } %}' +
            '</div>' +
            '</div>' +
            '</div>' +
            '<div class="info-wrap">' +
            '<div class="title">{%=file.name%}</div>' +
            '</div>' +
            '<div class="progress progress-striped active" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" role="progressbar">' +
            '<div class="progress-bar progress-bar-success" style="width:0%;"></div>' +
            '</div>' +
            '</div>' +
            '</div>' +
            '{% } %}'
        ),
        downloadTemplate: tmpl(
            '{% for (var i=0, file; file=o.files[i]; i++) { %}' +
            '<div class="file template-download fade col-lg-2 col-md-4 col-sm-6 {%=file.type.search("image") !== -1? "image" : "other-file"%}">' +
            '<div class="file-item">' +
            '<div class="preview vertical-align">' +
            '<div class="file-action-wrap">' +
            '<div class="file-action">' +
            '<i class="icon wb-trash delete" data-toggle="tooltip" data-original-title="Delete files" aria-hidden="true"></i>' +
            '</div>' +
            '</div>' +
            '<img src="{%=file.url%}"/>' +
            '</div>' +
            '<div class="info-wrap">' +
            '<div class="title">{%=file.name%}</div>' +
            '</div>' +
            '</div>' +
            '</div>' +
            '{% } %}'
        ),
        forceResize: true,
        previewCanvas: false,
        previewMaxWidth: false,
        previewMaxHeight: false,
        previewThumbnail: false
    }).on('fileuploadprocessalways', function (e, data) {
        var length = data.files.length;

        for (var i = 0; i < length; i++) {
            if (!data.files[i].type.match(/^image\/(gif|jpeg|png|svg\+xml)$/)) {
                data.files[i].filetype = 'other-file';
            } else {
                data.files[i].filetype = 'image';
            }
        }
    }).on('fileuploadadded', function (e) {
        var $this = $(e.target);

        if ($this.find('.file').length > 0) {
            $this.addClass('has-file');
        } else {
            $this.removeClass('has-file');
        }
    }).on('fileuploadfinished', function (e) {
        var $this = $(e.target);

        if ($this.find('.file').length > 0) {
            $this.addClass('has-file');
        } else {
            $this.removeClass('has-file');
        }
    }).on('fileuploaddestroyed', function (e) {
        var $this = $(e.target);

        if ($this.find('.file').length > 0) {
            $this.addClass('has-file');
        } else {
            $this.removeClass('has-file');
        }
    }).on('click', function (e) {
        if ($(e.target).parents('.file').length === 0) {
            $('#inputUpload').trigger('click');
        }
    });

    $(document).bind('dragover', function (e) {
        var dropZone = $exampleUploadForm,
            timeout = window.dropZoneTimeout;
        if (!timeout) {
            dropZone.addClass('in');
        } else {
            clearTimeout(timeout);
        }
        var found = false,
            node = e.target;
        do {
            if (node === dropZone[0]) {
                found = true;
                break;
            }
            node = node.parentNode;
        } while (node !== null);
        if (found) {
            dropZone.addClass('hover');
        } else {
            dropZone.removeClass('hover');
        }
        window.dropZoneTimeout = setTimeout(function () {
            window.dropZoneTimeout = null;
            dropZone.removeClass('in hover');
        }, 100);
    });

    $('#inputUpload').on('click', function (e) {
        e.stopPropagation();
    });

    $('#uploadlink').on('click', function (e) {
        e.stopPropagation();
    });
})(document, window, jQuery);
</script>